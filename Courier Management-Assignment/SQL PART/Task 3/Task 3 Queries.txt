--Task 3 Queries 
--14. Find the total number of couriers handled by each employee
select EmployeeID, count(CourierID) as Total_Couriers_Handled from Payment
group by EmployeeID
--15. Calculate the total revenue generated by each location 
select LocationID, SUM(Amount) AS TotalRevenue 
from Payment 
group by LocationID;
--16. Find the total number of couriers delivered to each location. 
select ReceiverAddress, COUNT(CourierID) AS TotalDeliveries from Couriers 
where Status = 'Delivered' 
group by ReceiverAddress;
--17. Find the courier with the highest average delivery time
SELECT top 1 CourierID, AVG(DATEDIFF(day, DeliveryDate, getdate())) AS AvgDeliveryTime 
FROM Couriers 
GROUP BY CourierID 
ORDER BY AvgDeliveryTime DESC 
--18. Find Locations with Total Payments Less Than a Certain Amount 
select LocationID, SUM(Amount) AS TotalPayment from Payment 
group by LocationID 
having sum(Amount) < 15
--19. Calculate Total Payments per Location 
select LocationID, SUM(Amount) AS TotalPayments from Payment 
group by LocationID;
--20. Retrieve couriers who have received payments totaling more than $1000 in a specific location (LocationID = 20)
SELECT CourierID, SUM(Amount) AS TotalPayments 
FROM Payment 
WHERE LocationID = 20
GROUP BY CourierID 
HAVING sum(Amount) > 1000;
--21. Retrieve couriers who have received payments totaling more than $1000 after a certain date (PaymentDate > 'YYYY-MM-DD')
SELECT CourierID, SUM(Amount) AS TotalPayments 
FROM Payment 
WHERE PaymentDate > '2025-03-09' 
GROUP BY CourierID 
HAVING sum(Amount) > 1000;
--22. Retrieve locations where the total amount received is more than $5000 before a certain date (PaymentDate > 'YYYY-MM-DD') 
update Payment set Amount = 5300 where PaymentID =16
select LocationID, SUM(Amount) AS TotalAmountReceived from Payment 
where PaymentDate > '2025-03-10' 
group by LocationID 
having sum(Amount) > 5000